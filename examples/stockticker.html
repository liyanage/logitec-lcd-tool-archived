<!-- stock ticker example. Works in Safari but not yet in the application -->
<html>
<head>
	<title>JavaScript Playground</title>

	<script type="text/javascript">
	
		function $(id) {return document.getElementById(id)}
	
		function update() {

			var data = sendRequest('http://wu.apple.com/fq/applewidgets/quote.asp?key=tHisIsApplewidgeTs&symbols=AAPL,AMZN');
			var div = $('quotes');
			div.innerHTML = "";

			var quotes = data.documentElement.getElementsByTagName('QUOTE');
			for (var i = 0; i < quotes.length; i++) {
				var quote = quotes.item(i);
				div.appendChild(quote2span(quote));
			}
		
		}

		function quote2span(quote) {
			var quotespan = document.createElement('span');
			quotespan.setAttribute('class', 'quote');

			var childs = quote.getElementsByTagName('*');
			for (var i = 0; i < childs.length; i++) {
				var child = childs.item(i);
				var span = document.createElement('span');
				span.setAttribute('class', child.nodeName);
				span.innerHTML = child.childNodes.item(0).nodeValue;
				quotespan.appendChild(span);
			}
			
			return quotespan
		}
		
		function sendRequest(url) {
			var request = new XMLHttpRequest();
			request.open("GET", url, false);
			request.send();
			if (request.status == 200) return request.responseXML;
			return false;
		}
	
		
	</script>

	<style type="text/css">
		.quote {
			border: 1px solid blue;
			margin: 2px;
			padding: 2px;
		}
		
		.quote span {
			margin-left: 5px;
		}
		
		.CHANGE:before {
			content: "Change ";
		}
	</style>

</head>
<body onload="update()">

	<marquee id="quotes"></marquee>
	
</body>
</html>
